{% extends 'base.html' %}

{% block content %}
<!-- <div class="cell-margin">
  <div class="mb-8">
    <h2>
      {% block title %}
      {% autoescape false %}
      {{ type + 's' | replace(" ","<br>") }}
      {% endautoescape %}
      {% endblock %}
    </h2>
    <p>
      Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque eget viverra magna. Nam in ante ultricies
      purus feugiat vestibulum et ac erat. Donec in sagittis ante. Maecenas non mauris et eros commodo fringilla.
      Integer accumsan ullamcorper diam, non rhoncus tellus molestie ut. Maecenas finibus pretium dolor ac sagittis.
    </p>
  </div>
</div> -->


    <div class="border-b-2 border-black grid grid-cols-[52rem,30rem]  content-start">
    
      <div class="ml-[13rem] text my-8 meta max-w-[30rem]">
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam ultricies egestas felis at dignissim. Morbi ut bibendum
            nisl. Integer ac sollicitudin risus. Vivamus et est est. Ut vitae lacus nec justo tincidunt interdum. Fusce sapien odio,
            commodo nec est et, interdum varius risus. Curabitur vehicula consequat auctor.
      </div>
      <div class="h-full ">
        <div class="flex h-full gap-8 justify-start items-center ">
          <div class="text-right">Show<br>related</div>
          <label class="switch">
            <input type="checkbox">
            <span class="slider round"></span>
          </label>
          <div class="">Simpler<br>List</div>
        </div>
      </div>
    </div>
<script>
  function filter() {
    return {
      expandFilters: false,
      init() {
        // console.log(this.showRelated)
      }
    }
  }
</script>
<div class="" x-data="filter()">
    <div id="resources" :class="expandFilters?'expanded':''">

      <br/><br/>
      <a href="{{ request.base_url }}?view=list{% for key in request.args %}{% if key != 'view' %}&{{ key }}={{ request.args.get(key) }}{% endif %}{% endfor %}">
        LIST VIEW
      </a>
      
        <div class="std-margin grid lg:grid-cols-4 mb-16">
            {% if practices_filter %}
            <div class="hidden lg:block cursor-pointer" @click="expandFilters = !expandFilters">Show/hide filters</div>
            <div class="">
                <div class="filter-header">Practices</div>
                <div class="filter-options my-4" x-show="expandFilters">
                {% for practice in practices_filter %}
                <div {% if request.args.get('practice')==practice[0]|string %} class="active" {% endif %}>
                    <a href="{{ request.base_url }}?practice={{ practice[0] }}{% for key in request.args %}{% if key != 'practice' %}&{{ key }}={{ request.args.get(key) }}{% endif %}{% endfor %}" hx-target="#resources" hx-select="#resources">{{ practice[1] }}</a>
                </div>
                {% endfor %}
                </div>
            </div>
            {% endif %}
            {% if year_filter %}
            <div class="">
                <div class="filter-header">Year</div>
                <div class="filter-options my-4" x-show="expandFilters">
                {% for year in year_filter %}
                <div  {% if year in request.args.getlist('year') %} class="active" {% endif %}>
                    <a href="{{ request.base_url }}?year={{ year }}{% for key in request.args %}{% if key != 'year' %}&{{ key }}={{ request.args.get(key) }}{% endif %}{% endfor %}" hx-target="#resources" hx-select="#resources">{{ year }}</a>
                </div>
                {% endfor %}
                </div>
            </div>
            {% endif %}
            {% if typology_filter %}
            <div class="">
                <div class="filter-header">Typology category</div>
                <div class="filter-options my-4" x-show="expandFilters">
                {% for typology in typology_filter %}
                <div {% if typology in request.args.getlist('typology') %} class="active" {% endif %}>
                    <a href="{{ request.base_url }}?typology={{ typology }}{% for key in request.args %}{% if key != 'typology' %}&{{ key }}={{ request.args.get(key) }}{% endif %}{% endfor %}" hx-target="#resources" hx-select="#resources">{{ typology }}</a>
                </div>
                {% endfor %}
                </div>
            </div>
            {% endif %}
            {% if languages_filter %}
            <div class="" >
                <div class="filter-header">Scripting languages</div>
                <div class="filter-options my-4" x-show="expandFilters">
                {% for language in languages_filter %}
                <div {% if language in request.args.getlist('scriptingLanguage') %} class="active" {% endif %}>
                    <a href="{{ request.base_url }}?scriptingLanguage={{ language }}{% for key in request.args %}{% if key != 'scriptingLanguage' %}&{{ key }}={{ request.args.get(key) }}{% endif %}{% endfor %}" hx-target="#resources" hx-select="#resources">{{ language }}</a>
                </div>
                {% endfor %}
                </div>
            </div>
            {% endif %}
            {% if licenses_filter %}
            <div class=""  >
                <div class="filter-header">License</div>
                <div class="filter-options my-4" x-show="expandFilters">
                {% for license in licenses_filter %}
                <div {% if license in request.args.getlist('license') %} class="active" {% endif %}>
                    <a href="{{ request.base_url }}?license={{ license }}{% for key in request.args %}{% if key != 'license' %}&{{ key }}={{ request.args.get(key) }}{% endif %}{% endfor %}" hx-target="#resources" hx-select="#resources">{{ license }}</a>
                </div>
                {% endfor %}
                </div>
            </div>
            {% endif %}
            {% if status_filter %}
            <div class=""  >
                <div class="filter-header">Status</div>
                <div class="filter-options my-4" x-show="expandFilters">
                {% for status in status_filter %}
                <div {% if status in request.args.getlist('status') %} class="active" {% endif %}>
                    <a href="{{ request.base_url }}?status={{ status }}{% for key in request.args %}{% if key != 'status' %}&{{ key }}={{ request.args.get(key) }}{% endif %}{% endfor %}" hx-target="#resources" hx-select="#resources">{{ status }}</a>
                </div>
                {% endfor %}
                </div>
            </div>
            {% endif %}
        </div>

        <div>
            {% if view == 'list' %}
              THIS IS LIST VIEW 
            {% else %}

            {% for resource in resources %}
              {{ resource_with_related(resource, loop) }}
            {% endfor %}

            {% endif %}
        </div>
    </div>
</div>


{% endblock %}